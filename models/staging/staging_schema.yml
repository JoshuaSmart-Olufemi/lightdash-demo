version: 2

models: 
  - name: stg_customer_orders
    description: a raw table representing the orders of customers over time
    columns: 
      - name: customer_id
        meta:
          metrics:
            count_of_customers: 
              label: 'total number of customers'
              type: count_distinct 
              sql: " count(${customer_id})"
      - name: order_id
        meta:
          metrics:
            count_of_orders:
              label: 'total number of orders'
              type: count_distinct
              sql: "count(${order_id})"
      - name: order_date
        meta:
          dimension:
            type: date
            time_intervals: ['DAY', 'WEEK', 'MONTH', 'QUARTER']

          additional_dimensions:
            years_since_cohort:
              type: number
              sql: " date_diff(current_date(), ${order_date}, year) "
            
            months_since_cohort:
              type: number
              sql: " date_diff(current_date(), ${order_date}, month) "
          
          

      - name: revenue
        meta:
          metrics:
            sum_revenue:
              label: 'sum of revenue'
              type: sum
